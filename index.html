<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Nothing</title>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
<style>
    body {
        margin: 0;
        background-color: #000;
        color: #fff;
        font-family: 'Arial', sans-serif;
        font-weight: 100;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
        -webkit-tap-highlight-color: transparent;
    }

    #start-screen, #game-screen {
        position: absolute;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: opacity 0.6s ease;
    }

    #start-screen { z-index: 2; }

    #game-screen.hidden { opacity: 0; pointer-events: none; }

    #title { font-size: 40px; font-weight: 100; text-align:center; margin-bottom:40px; }

    #question { font-size: 26px; text-align: center; font-weight: 100; margin: 20px; word-break: break-word; }

    #input-area { margin-top: 30px; border-bottom: 2px solid gray; width: 90%; display: flex; justify-content: center; }

    input {
        background: transparent;
        border: none;
        outline: none;
        color: #fff;
        font-weight: 100;
        font-size: 24px;
        text-align: center;
        width: 100%;
        caret-color: #fff;
    }

    #ok-btn, #restart-btn {
        margin-top: 30px;
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        font-weight: 100;
        cursor: pointer;
        user-select: none;
    }

    #ok-btn:active, #restart-btn:active { opacity: 0.6; }

    #feedback { margin-top: 20px; font-size: 18px; color: gray; font-weight: 100; }

    .hidden { opacity: 0; pointer-events: none; }

    #version {
        position: fixed;
        right: 10px;
        bottom: 10px;
        font-size: 16px;
        font-weight: 100;
    }

    #restart-icon {
        position: fixed;
        top: 10px;
        right: 10px;
        font-size: 28px;
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s;
        display: none; /* спочатку прихована */
    }

    #restart-icon:hover { opacity: 1; }

    .material-symbols-outlined {
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 40;
    }
</style>
</head>
<body>

<div id="start-screen">
    <div id="title">Nothing</div>
    <div style="font-size: 28px; text-align:center;">Hello. This is nothing</div>
    <div style="font-size: 18px; margin-top:20px;">Tap the screen to start</div>
</div>

<div id="game-screen" class="hidden">
    <div id="question">Question will appear here...</div>
    <div id="input-area">
        <input type="text" id="answer" placeholder="Type your answer...">
    </div>
    <button id="ok-btn">Ok</button>
    <div id="feedback"></div>
    <button id="restart-btn" style="display:none;">Restart Save</button>
</div>

<!-- Restart icon -->
<button id="restart-icon" title="Restart Save">
    <span class="material-symbols-outlined">restart_alt</span>
</button>

<div id="version">v1.0.3</div>

<script>
let firstAnswer = "";
let locked = false;
let hue = 0;

// Questions
const questions = [
    { q: "Hello. This is nothing", a: "any", any: true },
    { q: "What was the correct answer in the previous task?", a: () => firstAnswer },
    { q: "(2 + 2) × 2", a: "8" },
    { q: "What number is this question?", a: "4" },
    { q: "+", a: "plus" },
    { q: "Backwards", a: "sdrawkcab" },
    { q: "First letter", a: "f" },
    { q: "", a: "any", any: true },
    { q: "(Just a space)", a: ["nothing", " "], allowEmpty: true },
    { q: "End?", a: "yes" },
    { q: "What day is today?", a: "any", any: true },
    { q: "Type 'night'", a: "night" },
    { q: "What comes after A?", a: "b" },
    { q: "How many letters?", a: "15" },
    { q: "Type )*", a: "type" },
    { q: "What color is darkness?", a: "black" },
    { q: "What if you type nothing?", a: "", allowEmpty: true },
    { q: "2 (- + -) 2", a: "4" },
    { q: "Understood?", a: "Dootsrednu" },
    { q: "Is this the last question?", a: "yes" },
    { q: "A B", a: "C" }, // fixed
    { q: "Is 0 nothing?", a: ["Maybe", "No"] },
    { q: "Blue + Red =", a: "Purple" },
    { q: "What was the answer to question 1?", a: () => firstAnswer },
    { q: "RGB", a: ["RedGreenBlue", "Red Green Blue"] },
    { q: "How many percent battery do you have?", a: "any", any: true }
];

let current = Number(localStorage.getItem("currentQuestion")) || 0;

const startScreen = document.getElementById("start-screen");
const gameScreen = document.getElementById("game-screen");
const restartBtn = document.getElementById("restart-btn");
const restartIcon = document.getElementById("restart-icon");
const answerInput = document.getElementById("answer");
const versionEl = document.getElementById("version");

// Beep sound
function beep() {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = "square";
    osc.frequency.value = 800;
    gain.gain.value = 0.1;
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.05);
}

// Animate version
function animateVersion() {
    hue = (hue + 0.5) % 360;
    versionEl.style.color = `hsl(${hue}, 100%, 50%)`;
    requestAnimationFrame(animateVersion);
}
animateVersion();

// Start screen
startScreen.addEventListener("click", () => {
    startScreen.style.opacity = 0;
    setTimeout(() => {
        startScreen.classList.add("hidden");
        gameScreen.classList.remove("hidden");
        showQuestion();
    }, 600);
});

// Input typing
answerInput.addEventListener("input", () => { beep(); });

// Show question
function showQuestion() {
    if (current < questions.length) {
        const q = questions[current].q;
        document.getElementById("question").textContent = q;
        answerInput.value = "";
        document.getElementById("feedback").textContent = "";
        fadeIn();
        locked = false;
        restartIcon.style.display = "block"; // показати кнопку тільки під час гри
    } else {
        fadeOut(() => {
            document.getElementById("question").textContent = "The End.";
            document.getElementById("input-area").style.display = "none";
            document.getElementById("ok-btn").style.display = "none";
            document.getElementById("feedback").textContent = "";
            restartBtn.style.display = "block";
            restartIcon.style.display = "none"; // приховати іконку після проходження
        });
    }
}

// Fade
function fadeOut(callback) {
    locked = true;
    document.getElementById("question").classList.add("hidden");
    document.getElementById("input-area").classList.add("hidden");
    document.getElementById("ok-btn").classList.add("hidden");
    document.getElementById("feedback").classList.add("hidden");
    setTimeout(() => { callback(); }, 600);
}

function fadeIn() {
    document.getElementById("question").classList.remove("hidden");
    document.getElementById("input-area").classList.remove("hidden");
    document.getElementById("ok-btn").classList.remove("hidden");
    document.getElementById("feedback").classList.remove("hidden");
    locked = false;
}

// Check
document.getElementById("ok-btn").addEventListener("click", () => {
    if (locked) return;

    let userAnswer = answerInput.value.trim();
    const q = questions[current];

    let correctAnswer;
    if (typeof q.a === "function") correctAnswer = q.a();
    else correctAnswer = q.a;

    let isCorrect = false;

    if (q.any) {
        isCorrect = userAnswer.length > 0;
        if (current === 0) firstAnswer = userAnswer;
    } else if (q.allowEmpty) {
        if (userAnswer === "" || userAnswer === " ") isCorrect = true;
        else if (Array.isArray(correctAnswer)) isCorrect = correctAnswer.some(ans => ans.toLowerCase() === userAnswer.toLowerCase());
        else isCorrect = userAnswer.toLowerCase() === correctAnswer.toLowerCase();
    } else if (Array.isArray(correctAnswer)) {
        isCorrect = correctAnswer.some(ans => ans.toLowerCase() === userAnswer.toLowerCase());
    } else {
        isCorrect = userAnswer.toLowerCase() === correctAnswer.toLowerCase();
    }

    if (isCorrect) {
        fadeOut(() => {
            current++;
            localStorage.setItem("currentQuestion", current);
            showQuestion();
        });
    } else {
        document.getElementById("feedback").textContent = "Incorrect. Try again.";
    }
});

// Restart big button
restartBtn.addEventListener("click", restartGame);
// Restart icon
restartIcon.addEventListener("click", restartGame);

function restartGame() {
    current = 0;
    localStorage.removeItem("currentQuestion");
    restartBtn.style.display = "none";
    document.getElementById("input-area").style.display = "flex";
    document.getElementById("ok-btn").style.display = "block";
    showQuestion();
}
</script>
</body>
</html>
